# üé£ Custom Hooks Usage Guide

## üì¶ C√†i ƒë·∫∑t

T·∫°o th∆∞ m·ª•c `src/hooks/` v√† ƒë·∫∑t 3 files:
- `useAuth.js`
- `useJobs.js`
- `useLocalStorage.js`
- `index.js` (export t·∫•t c·∫£)

---

## 1. üîê useAuth Hook

Hook ƒë·ªÉ qu·∫£n l√Ω authentication (ƒëƒÉng nh·∫≠p, ƒëƒÉng k√Ω, logout).

### Import
```javascript
import { useAuth } from '../hooks';
```

### Basic Usage

```javascript
function LoginPage() {
  const { 
    user, 
    isLoggedIn, 
    login, 
    logout, 
    loading, 
    error 
  } = useAuth();

  const handleLogin = async (e) => {
    e.preventDefault();
    const result = await login(email, password);
    
    if (result.success) {
      console.log('ƒêƒÉng nh·∫≠p th√†nh c√¥ng!', result.user);
      // Navigate ho·∫∑c l√†m g√¨ ƒë√≥
    } else {
      console.error('L·ªói:', result.error);
    }
  };

  if (loading) return <div>Loading...</div>;

  return (
    <div>
      {isLoggedIn ? (
        <div>
          <p>Xin ch√†o, {user?.name}!</p>
          <button onClick={logout}>ƒêƒÉng xu·∫•t</button>
        </div>
      ) : (
        <form onSubmit={handleLogin}>
          {/* Login form */}
        </form>
      )}
      {error && <div className="error">{error}</div>}
    </div>
  );
}
```

### Available Methods

```javascript
const {
  user,              // Object: Th√¥ng tin user hi·ªán t·∫°i
  isLoggedIn,        // Boolean: Tr·∫°ng th√°i ƒëƒÉng nh·∫≠p
  loading,           // Boolean: Loading state
  error,             // String: Error message
  
  login,             // Function(email, password): ƒêƒÉng nh·∫≠p
  logout,            // Function(): ƒêƒÉng xu·∫•t
  register,          // Function(userData): ƒêƒÉng k√Ω
  updateUser,        // Function(updatedData): C·∫≠p nh·∫≠t profile
  changePassword,    // Function(oldPass, newPass): ƒê·ªïi m·∫≠t kh·∫©u
  checkAuth,         // Function(): Ki·ªÉm tra auth
  clearError         // Function(): X√≥a error
} = useAuth();
```

### Examples

**ƒêƒÉng k√Ω:**
```javascript
const handleRegister = async () => {
  const result = await register({
    name: 'John Doe',
    email: 'john@example.com',
    password: 'password123'
  });
  
  if (result.success) {
    // Auto login sau khi ƒëƒÉng k√Ω
  }
};
```

**C·∫≠p nh·∫≠t profile:**
```javascript
const handleUpdateProfile = async () => {
  const result = await updateUser({
    name: 'New Name',
    phone: '0123456789'
  });
};
```

**ƒê·ªïi m·∫≠t kh·∫©u:**
```javascript
const handleChangePassword = async () => {
  const result = await changePassword('oldPassword', 'newPassword');
  if (result.success) {
    alert('ƒê·ªïi m·∫≠t kh·∫©u th√†nh c√¥ng!');
  }
};
```

---

## 2. üíº useJobs Hook

Hook ƒë·ªÉ qu·∫£n l√Ω jobs (fetch, filter, sort, search).

### Import
```javascript
import { useJobs } from '../hooks';
```

### Basic Usage

```javascript
function JobListPage() {
  const {
    filteredJobs,
    loading,
    error,
    filters,
    updateFilters,
    resetFilters,
    sortBy,
    updateSort
  } = useJobs();

  if (loading) return <div>Loading jobs...</div>;
  if (error) return <div>Error: {error}</div>;

  return (
    <div>
      {/* Filters */}
      <button onClick={() => updateFilters({ location: 'h√† n·ªôi' })}>
        H√† N·ªôi
      </button>
      <button onClick={resetFilters}>Reset Filters</button>

      {/* Jobs */}
      <div className="jobs-grid">
        {filteredJobs.map(job => (
          <JobCard key={job.id} job={job} />
        ))}
      </div>
    </div>
  );
}
```

### Available Methods

```javascript
const {
  jobs,                    // Array: T·∫•t c·∫£ jobs
  filteredJobs,           // Array: Jobs sau khi filter/sort
  loading,                // Boolean: Loading state
  error,                  // String: Error message
  pagination,             // Object: Th√¥ng tin ph√¢n trang
  filters,                // Object: Current filters
  sortBy,                 // String: Current sort method
  
  fetchJobs,              // Function(page): Fetch jobs
  getJobById,             // Function(id): Get single job
  getJobsByCategory,      // Function(category): Get by category
  searchJobs,             // Function(query): Search
  updateFilters,          // Function(filters): Update filters
  resetFilters,           // Function(): Reset all filters
  updateSort,             // Function(sortMethod): Update sort
  clearError,             // Function(): Clear error
  refresh                 // Function(): Refresh data
} = useJobs();
```

### Examples

**Filter jobs:**
```javascript
// Filter by location
updateFilters({ location: 'h·ªì ch√≠ minh' });

// Multiple filters
updateFilters({
  location: 'h√† n·ªôi',
  salary: 'over30',
  experience: '2-3'
});

// Reset
resetFilters();
```

**Sort jobs:**
```javascript
updateSort('newest');    // M·ªõi nh·∫•t
updateSort('oldest');    // C≈© nh·∫•t
updateSort('salary_high'); // L∆∞∆°ng cao
```

**Search:**
```javascript
const handleSearch = async (query) => {
  const result = await searchJobs(query);
  if (result.success) {
    console.log('Found:', result.data.length, 'jobs');
  }
};
```

**Get job by ID:**
```javascript
const loadJobDetail = async (jobId) => {
  const result = await getJobById(jobId);
  if (result.success) {
    setCurrentJob(result.data);
  }
};
```

**Disable auto-fetch:**
```javascript
const { fetchJobs } = useJobs({ autoFetch: false });

// Manual fetch khi c·∫ßn
useEffect(() => {
  fetchJobs();
}, []);
```

---

## 3. üíæ useLocalStorage Hook

Hook ƒë·ªÉ l∆∞u tr·ªØ data v√†o localStorage v·ªõi React state sync.

### Import
```javascript
import { 
  useLocalStorage,
  useSavedJobs,
  useSearchHistory,
  useUserPreferences,
  useFormDraft,
  useRecentViews
} from '../hooks';
```

### Basic Usage

```javascript
function MyComponent() {
  const [name, setName, removeName] = useLocalStorage('userName', 'Guest');

  return (
    <div>
      <input 
        value={name} 
        onChange={(e) => setName(e.target.value)} 
      />
      <button onClick={removeName}>Clear</button>
    </div>
  );
}
```

### 3.1 useSavedJobs

L∆∞u danh s√°ch jobs ƒë√£ bookmark.

```javascript
function JobCard({ job }) {
  const { savedJobs, saveJob, unsaveJob, isJobSaved } = useSavedJobs();
  
  const isSaved = isJobSaved(job.id);

  const handleToggleSave = () => {
    if (isSaved) {
      unsaveJob(job.id);
    } else {
      saveJob(job);
    }
  };

  return (
    <div>
      <h3>{job.title}</h3>
      <button onClick={handleToggleSave}>
        {isSaved ? '‚ù§Ô∏è ƒê√£ l∆∞u' : 'ü§ç L∆∞u'}
      </button>
    </div>
  );
}

// Hi·ªÉn th·ªã danh s√°ch saved jobs
function SavedJobsPage() {
  const { savedJobs, clearAllSavedJobs } = useSavedJobs();

  return (
    <div>
      <h2>Jobs ƒë√£ l∆∞u ({savedJobs.length})</h2>
      {savedJobs.map(job => <JobCard key={job.id} job={job} />)}
      <button onClick={clearAllSavedJobs}>X√≥a t·∫•t c·∫£</button>
    </div>
  );
}
```

### 3.2 useSearchHistory

L∆∞u l·ªãch s·ª≠ t√¨m ki·∫øm.

```javascript
function SearchBar() {
  const { searchHistory, addSearch, removeSearch, clearHistory } = useSearchHistory(10);
  const [query, setQuery] = useState('');

  const handleSearch = () => {
    addSearch(query);
    // Th·ª±c hi·ªán t√¨m ki·∫øm...
  };

  return (
    <div>
      <input 
        value={query} 
        onChange={(e) => setQuery(e.target.value)} 
      />
      <button onClick={handleSearch}>T√¨m</button>

      {/* Recent searches */}
      <div className="recent-searches">
        <h4>T√¨m ki·∫øm g·∫ßn ƒë√¢y:</h4>
        {searchHistory.map((term, idx) => (
          <div key={idx}>
            <span onClick={() => setQuery(term)}>{term}</span>
            <button onClick={() => removeSearch(term)}>√ó</button>
          </div>
        ))}
        <button onClick={clearHistory}>X√≥a l·ªãch s·ª≠</button>
      </div>
    </div>
  );
}
```

### 3.3 useUserPreferences

L∆∞u preferences c·ªßa user.

```javascript
function SettingsPage() {
  const { preferences, updatePreference, updatePreferences } = useUserPreferences();

  return (
    <div>
      <label>
        <input
          type="checkbox"
          checked={preferences.notifications}
          onChange={(e) => updatePreference('notifications', e.target.checked)}
        />
        B·∫≠t th√¥ng b√°o
      </label>

      <label>
        <input
          type="checkbox"
          checked={preferences.emailAlerts}
          onChange={(e) => updatePreference('emailAlerts', e.target.checked)}
        />
        Email alerts
      </label>

      <select 
        value={preferences.theme}
        onChange={(e) => updatePreference('theme', e.target.value)}
      >
        <option value="light">Light</option>
        <option value="dark">Dark</option>
      </select>
    </div>
  );
}
```

### 3.4 useFormDraft

T·ª± ƒë·ªông l∆∞u draft c·ªßa form (tr√°nh m·∫•t d·ªØ li·ªáu).

```javascript
function JobApplicationForm() {
  const { draft, saveDraft, hasDraft, clearDraft } = useFormDraft('jobApplication');
  const [formData, setFormData] = useState(draft || {
    name: '',
    email: '',
    phone: '',
    coverLetter: ''
  });

  // Auto-save draft m·ªói 5 gi√¢y
  useEffect(() => {
    const timer = setInterval(() => {
      saveDraft(formData);
    }, 5000);
    return () => clearInterval(timer);
  }, [formData, saveDraft]);

  const handleSubmit = () => {
    // Submit form...
    clearDraft(); // X√≥a draft sau khi submit th√†nh c√¥ng
  };

  return (
    <form onSubmit={handleSubmit}>
      {hasDraft() && <div>‚ö†Ô∏è C√≥ b·∫£n nh√°p ƒë√£ l∆∞u</div>}
      {/* Form fields */}
    </form>
  );
}
```

### 3.5 useRecentViews

L∆∞u jobs ƒë√£ xem g·∫ßn ƒë√¢y.

```javascript
function JobDetailPage({ jobId }) {
  const { addView } = useRecentViews(5);
  const [job, setJob] = useState(null);

  useEffect(() => {
    // Fetch job detail...
    fetchJob(jobId).then(jobData => {
      setJob(jobData);
      addView(jobData); // L∆∞u v√†o recent views
    });
  }, [jobId, addView]);

  return <div>{/* Job detail */}</div>;
}

// Hi·ªÉn th·ªã recent views
function RecentViewsSection() {
  const { recentViews, removeView, clearRecentViews } = useRecentViews();

  return (
    <div>
      <h3>ƒê√£ xem g·∫ßn ƒë√¢y</h3>
      {recentViews.map(job => (
        <div key={job.id}>
          <JobCard job={job} />
          <button onClick={() => removeView(job.id)}>X√≥a</button>
        </div>
      ))}
    </div>
  );
}
```

---

## üéØ Best Practices

1. **useAuth:** Wrap app v·ªõi AuthProvider ho·∫∑c d√πng hook n√†y ·ªü top-level
2. **useJobs:** D√πng `autoFetch: false` n·∫øu mu·ªën control vi·ªác fetch manually
3. **useLocalStorage:** Prefix keys ƒë·ªÉ tr√°nh conflict (e.g., `app_userName`)
4. **Error Handling:** Lu√¥n check `result.success` tr∆∞·ªõc khi s·ª≠ d·ª•ng data
5. **Loading States:** Hi·ªÉn th·ªã loading indicator khi `loading === true`

---

## üìù Notes

- T·∫•t c·∫£ hooks ƒë·ªÅu c√≥ error handling built-in
- localStorage hooks t·ª± ƒë·ªông sync gi·ªØa c√°c tabs
- C√≥ th·ªÉ customize b·∫±ng c√°ch modify hooks theo nhu c·∫ßu
- Backend endpoints c√≥ th·ªÉ kh√°c, update URLs trong hooks

---

## üöÄ Quick Start

```javascript
// App.js
import { useAuth, useJobs, useSavedJobs } from './hooks';

function App() {
  const { isLoggedIn, user } = useAuth();
  const { filteredJobs, loading } = useJobs();
  const { savedJobs } = useSavedJobs();

  return (
    <div>
      {isLoggedIn && <p>Welcome, {user?.name}!</p>}
      <p>Total Jobs: {filteredJobs.length}</p>
      <p>Saved Jobs: {savedJobs.length}</p>
    </div>
  );
}
```